{
  "id": "k0KDROZ2jmvpByjj",
  "name": "My workflow 5",
  "nodes": [
    {
      "parameters": {
        "updates": [
          "*"
        ],
        "additionalFields": {}
      },
      "id": "a82fcefb-1cfd-44c6-ab1e-2f2709079a35",
      "name": "üì± Telegram Trigger",
      "type": "n8n-nodes-base.telegramTrigger",
      "position": [
        352,
        -1035.3488958990538
      ],
      "webhookId": "fitness-bot-webhook",
      "typeVersion": 1.2,
      "credentials": {
        "telegramApi": {
          "id": "bRtnxneEgvSWdsIe",
          "name": "–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç –ø–æ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥—É"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 1
          },
          "conditions": [
            {
              "leftValue": "={{ (() => {\n  const msg = $json.message || {};\n  if (msg.text) return 'text';\n  if (msg.photo) return 'photo';\n  return 'other';\n})() }}",
              "rightValue": "text",
              "operator": {
                "type": "string",
                "operation": "contains"
              },
              "id": "5bab7682-d966-4a11-988f-390ee1047566"
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "699b06f6-86d7-49a2-b918-6257689330e4",
      "name": "üîç –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ç–∏–ø –≤—Ö–æ–¥–∞",
      "type": "n8n-nodes-base.if",
      "position": [
        576,
        -1035.3488958990538
      ],
      "typeVersion": 2
    },
    {
      "parameters": {
        "jsCode": "// –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è\nconst userId = $input.first().json.message.from.id;\nconst userName = $input.first().json.message.from.first_name;\nconst userText = $input.first().json.message.text;\n\n// –ü—Ä–æ–≤–µ—Ä—è–µ–º, —ç—Ç–æ –ø–µ—Ä–≤–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –∏–ª–∏ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ\nlet userProfile = {};\ntry {\n  // –ü—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –∏–∑ –±–∞–∑—ã (–∑–¥–µ—Å—å –∏—Å–ø–æ–ª—å–∑—É–µ–º —É–ø—Ä–æ—â–µ–Ω–Ω—É—é –ª–æ–≥–∏–∫—É)\n  userProfile = $vars.userProfiles?.[userId] || {};\n} catch (error) {\n  userProfile = {};\n}\n\n// –ï—Å–ª–∏ –ø—Ä–æ—Ñ–∏–ª—å –ø—É—Å—Ç–æ–π, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º\nif (!userProfile.name) {\n  userProfile = {\n    id: userId,\n    name: userName,\n    registration_date: new Date().toISOString(),\n    fitness_level: null,\n    goals: [],\n    current_weight: null,\n    target_weight: null,\n    height: null,\n    age: null,\n    gender: null,\n    medical_conditions: [],\n    workout_history: [],\n    preferences: {\n      workout_types: [],\n      equipment_available: [],\n      time_available: null,\n      intensity_preference: null\n    },\n    progress: {\n      workouts_completed: 0,\n      total_training_time: 0,\n      achievements: []\n    }\n  };\n}\n\n// –û–±–Ω–æ–≤–ª—è–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ\n$vars.userProfiles = $vars.userProfiles || {};\n$vars.userProfiles[userId] = userProfile;\n\n// –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –∑–∞–ø—Ä–æ—Å–∞\nlet requestType = 'general';\nif (userText) {\n  const text = userText.toLowerCase();\n  if (text.includes('–≤–µ—Å') || text.includes('–ø–æ—Ö—É–¥–µ—Ç—å') || text.includes('–Ω–∞–±—Ä–∞—Ç—å')) {\n    requestType = 'weight_management';\n  } else if (text.includes('—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞') || text.includes('—É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è') || text.includes('–ø—Ä–æ–≥—Ä–∞–º–º–∞')) {\n    requestType = 'workout_request';\n  } else if (text.includes('–¥–∏–µ—Ç–∞') || text.includes('–ø–∏—Ç–∞–Ω–∏–µ') || text.includes('–∫–∞–ª–æ—Ä–∏–∏')) {\n    requestType = 'nutrition';\n  } else if (text.includes('–ø—Ä–æ–≥—Ä–µ—Å—Å') || text.includes('—Ä–µ–∑—É–ª—å—Ç–∞—Ç') || text.includes('—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞')) {\n    requestType = 'progress';\n  }\n}\n\nreturn {\n  json: {\n    ...($input.first().json),\n    userProfile: userProfile,\n    requestType: requestType,\n    isNewUser: !userProfile.fitness_level\n  }\n};"
      },
      "id": "4c4a78db-693f-4c06-a866-21e7ae820be1",
      "name": "üë§ –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –ø—Ä–æ—Ñ–∏–ª—è",
      "type": "n8n-nodes-base.code",
      "position": [
        800,
        -1183.3488958990538
      ],
      "typeVersion": 2
    },
    {
      "parameters": {
        "jsCode": "// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–æ–º–ø—Ç–∞ –¥–ª—è –ò–ò —Ç—Ä–µ–Ω–µ—Ä–∞\nconst profile = $json.userProfile;\nconst requestType = $json.requestType;\nconst isNewUser = $json.isNewUser;\nconst userMessage = $json.message.text;\n\nlet basePrompt = `–¢—ã –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ñ–∏—Ç–Ω–µ—Å-—Ç—Ä–µ–Ω–µ—Ä –∏ –∫–æ—É—á —Å 15-–ª–µ—Ç–Ω–∏–º —Å—Ç–∞–∂–µ–º. \n–¢–≤–æ—è –∑–∞–¥–∞—á–∞ - —Å–æ–∑–¥–∞–≤–∞—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –∏ –¥–∞–≤–∞—Ç—å —ç–∫—Å–ø–µ—Ä—Ç–Ω—ã–µ —Å–æ–≤–µ—Ç—ã.\n\n`;\n\n// –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ\nlet userInfo = `–ü–†–û–§–ò–õ–¨ –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø:\n`;\nif (profile.name) userInfo += `–ò–º—è: ${profile.name}\n`;\nif (profile.age) userInfo += `–í–æ–∑—Ä–∞—Å—Ç: ${profile.age}\n`;\nif (profile.gender) userInfo += `–ü–æ–ª: ${profile.gender}\n`;\nif (profile.height) userInfo += `–†–æ—Å—Ç: ${profile.height} —Å–º\n`;\nif (profile.current_weight) userInfo += `–¢–µ–∫—É—â–∏–π –≤–µ—Å: ${profile.current_weight} –∫–≥\n`;\nif (profile.target_weight) userInfo += `–¶–µ–ª–µ–≤–æ–π –≤–µ—Å: ${profile.target_weight} –∫–≥\n`;\nif (profile.fitness_level) userInfo += `–£—Ä–æ–≤–µ–Ω—å –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏: ${profile.fitness_level}\n`;\nif (profile.goals.length > 0) userInfo += `–¶–µ–ª–∏: ${profile.goals.join(', ')}\n`;\nif (profile.medical_conditions.length > 0) userInfo += `–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è: ${profile.medical_conditions.join(', ')}\n`;\n\n// –ü—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è\nlet preferences = ``;\nif (profile.preferences.workout_types.length > 0) {\n  preferences += `–ü—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è –ø–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞–º: ${profile.preferences.workout_types.join(', ')}\n`;\n}\nif (profile.preferences.equipment_available.length > 0) {\n  preferences += `–î–æ—Å—Ç—É–ø–Ω–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ: ${profile.preferences.equipment_available.join(', ')}\n`;\n}\nif (profile.preferences.time_available) {\n  preferences += `–í—Ä–µ–º—è –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É: ${profile.preferences.time_available} –º–∏–Ω—É—Ç\n`;\n}\nif (profile.preferences.intensity_preference) {\n  preferences += `–ü—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–µ –ø–æ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–∏: ${profile.preferences.intensity_preference}\n`;\n}\n\n// –ü—Ä–æ–≥—Ä–µ—Å—Å\nlet progressInfo = ``;\nif (profile.progress.workouts_completed > 0) {\n  progressInfo += `–í—ã–ø–æ–ª–Ω–µ–Ω–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫: ${profile.progress.workouts_completed}\n`;\n  progressInfo += `–û–±—â–µ–µ –≤—Ä–µ–º—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫: ${Math.round(profile.progress.total_training_time / 60)} —á–∞—Å–æ–≤\n`;\n}\n\n// –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã –ø–æ —Ç–∏–ø—É –∑–∞–ø—Ä–æ—Å–∞\nlet specificPrompt = '';\n\nswitch (requestType) {\n  case 'workout_request':\n    specificPrompt = `\n–ó–ê–î–ê–ß–ê: –°–æ–∑–¥–∞–π –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.\n\n–¢–†–ï–ë–û–í–ê–ù–ò–Ø –ö –ü–†–û–ì–†–ê–ú–ú–ï:\n1. –£—á—Ç–∏ —É—Ä–æ–≤–µ–Ω—å –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∏ —Ü–µ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è\n2. –í–∫–ª—é—á–∏ —Ä–∞–∑–º–∏–Ω–∫—É (5-10 –º–∏–Ω)\n3. –û—Å–Ω–æ–≤–Ω—É—é —á–∞—Å—Ç—å (20-45 –º–∏–Ω –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏)\n4. –ó–∞–º–∏–Ω–∫—É –∏ —Ä–∞—Å—Ç—è–∂–∫—É (5-10 –º–∏–Ω)\n5. –£–∫–∞–∂–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥—Ö–æ–¥–æ–≤, –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π –∏ –≤—Ä–µ–º—è –æ—Ç–¥—ã—Ö–∞\n6. –î–æ–±–∞–≤—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è\n7. –í–∫–ª—é—á–∏ —Å–æ–≤–µ—Ç—ã –ø–æ —Ç–µ—Ö–Ω–∏–∫–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏\n\n–§–û–†–ú–ê–¢ –û–¢–í–ï–¢–ê:\nüèãÔ∏è **–ü–ï–†–°–û–ù–ê–õ–¨–ù–ê–Ø –¢–†–ï–ù–ò–†–û–í–ö–ê**\nüìä –°–ª–æ–∂–Ω–æ—Å—Ç—å: [—É—Ä–æ–≤–µ–Ω—å] | –í—Ä–µ–º—è: [–≤—Ä–µ–º—è] –º–∏–Ω | –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ: [—Å–ø–∏—Å–æ–∫]\n\n**üî• –†–ê–ó–ú–ò–ù–ö–ê (5-10 –º–∏–Ω)**\n[—Å–ø–∏—Å–æ–∫ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π]\n\n**üí™ –û–°–ù–û–í–ù–ê–Ø –ß–ê–°–¢–¨**\n[–¥–µ—Ç–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ —Å –ø–æ–¥—Ö–æ–¥–∞–º–∏ –∏ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è–º–∏]\n\n**üßò –ó–ê–ú–ò–ù–ö–ê –ò –†–ê–°–¢–Ø–ñ–ö–ê**\n[—É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –Ω–∞ —Ä–∞—Å—Ç—è–∂–∫—É]\n\n**‚ö†Ô∏è –í–ê–ñ–ù–´–ï –°–û–í–ï–¢–´**\n[—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ç–µ—Ö–Ω–∏–∫–µ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏]\n\n**üìà –ü–†–û–ì–†–ï–°–°–ò–Ø**\n[–∫–∞–∫ —É—Å–ª–æ–∂–Ω–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É –≤ –±—É–¥—É—â–µ–º]`;\n    break;\n\n  case 'nutrition':\n    specificPrompt = `\n–ó–ê–î–ê–ß–ê: –î–∞–π —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø–∏—Ç–∞–Ω–∏—é —Å —É—á–µ—Ç–æ–º —Ü–µ–ª–µ–π –∏ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.\n\n–í–ö–õ–Æ–ß–ò:\n1. –†–∞—Å—á–µ—Ç –∫–∞–ª–æ—Ä–∏–π –∏ –ë–ñ–£\n2. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø—Ä–∏–µ–º–∞–º –ø–∏—â–∏\n3. –°–ø–∏—Å–æ–∫ –ø–æ–ª–µ–∑–Ω—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤\n4. –ü—Ä–∏–º–µ—Ä–Ω–æ–µ –º–µ–Ω—é –Ω–∞ –¥–µ–Ω—å\n5. –°–æ–≤–µ—Ç—ã –ø–æ –≥–∏–¥—Ä–∞—Ç–∞—Ü–∏–∏\n\n–§–û–†–ú–ê–¢:\nüçé **–ü–õ–ê–ù –ü–ò–¢–ê–ù–ò–Ø**\nüìä –ö–∞–ª–æ—Ä–∏–∏: [—á–∏—Å–ª–æ] –∫–∫–∞–ª | –ë–µ–ª–∫–∏: [–≥] | –ñ–∏—Ä—ã: [–≥] | –£–≥–ª–µ–≤–æ–¥—ã: [–≥]\n\n**ü•ó –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò**\n[–¥–µ—Ç–∞–ª—å–Ω—ã–µ —Å–æ–≤–µ—Ç—ã]\n\n**üìã –ü–†–ò–ú–ï–†–ù–û–ï –ú–ï–ù–Æ**\n[–º–µ–Ω—é –Ω–∞ –¥–µ–Ω—å]`;\n    break;\n\n  case 'progress':\n    specificPrompt = `\n–ó–ê–î–ê–ß–ê: –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –¥–∞–π —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏.\n\n–í–ö–õ–Æ–ß–ò:\n1. –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–∏—Ö –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π\n2. –û–±–ª–∞—Å—Ç–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è\n3. –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ\n4. –ú–æ—Ç–∏–≤–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–æ–≤–µ—Ç—ã\n\n–§–û–†–ú–ê–¢:\nüìà **–ê–ù–ê–õ–ò–ó –ü–†–û–ì–†–ï–°–°–ê**\n[–¥–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏]`;\n    break;\n\n  default:\n    if (isNewUser) {\n      specificPrompt = `\n–ó–ê–î–ê–ß–ê: –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–π –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø–æ–º–æ–≥–∏ –µ–º—É –Ω–∞—á–∞—Ç—å —Ñ–∏—Ç–Ω–µ—Å-–ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ.\n\n–í–ö–õ–Æ–ß–ò:\n1. –î—Ä—É–∂–µ–ª—é–±–Ω–æ–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ\n2. –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –±–æ—Ç–∞\n3. –ü—Ä–æ—Å—å–±—É –∑–∞–ø–æ–ª–Ω–∏—Ç—å –±–∞–∑–æ–≤—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–µ–±–µ\n4. –ú–æ—Ç–∏–≤–∏—Ä—É—é—â–∏–π –ø—Ä–∏–∑—ã–≤ –∫ –¥–µ–π—Å—Ç–≤–∏—é\n\n–§–û–†–ú–ê–¢:\nüëã **–î–û–ë–†–û –ü–û–ñ–ê–õ–û–í–ê–¢–¨!**\n[–ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏]`;\n    } else {\n      specificPrompt = `\n–ó–ê–î–ê–ß–ê: –û—Ç–≤–µ—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫–∞–∫ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ç—Ä–µ–Ω–µ—Ä.\n\n–¢–ò–ü –û–¢–í–ï–¢–ê: –≠–∫—Å–ø–µ—Ä—Ç–Ω—ã–π —Å–æ–≤–µ—Ç —Å —É—á–µ—Ç–æ–º –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.`;\n    }\n}\n\n// –§–∏–Ω–∞–ª—å–Ω—ã–π –ø—Ä–æ–º–ø—Ç\nconst finalPrompt = basePrompt + userInfo + preferences + progressInfo + specificPrompt + `\n\n–í–û–ü–†–û–°/–ó–ê–ü–†–û–° –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø: \"${userMessage}\"\n\n–û—Ç–≤–µ—á–∞–π –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ, –±—É–¥—å –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–º, –º–æ—Ç–∏–≤–∏—Ä—É—é—â–∏–º –∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–º. –ò—Å–ø–æ–ª—å–∑—É–π —ç–º–æ–¥–∑–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –≤–æ—Å–ø—Ä–∏—è—Ç–∏—è.`;\n\nreturn {\n  json: {\n    ...$json,\n    aiPrompt: finalPrompt\n  }\n};"
      },
      "id": "0caf7057-a286-49a8-9cde-5c0d876b7f93",
      "name": "üìù –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø—Ä–æ–º–ø—Ç–æ–≤",
      "type": "n8n-nodes-base.code",
      "position": [
        1024,
        -1183.3488958990538
      ],
      "typeVersion": 2
    },
    {
      "parameters": {
        "jsCode": "// –°–±–æ—Ä —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ –ò–ò\nconst aiResponse = $json.content?.parts?.slice(-1)[0] || '–û—Ç–≤–µ—Ç –Ω–µ –ø–æ–ª—É—á–µ–Ω.';\nconst chatId = $json.message?.chat?.id;\n\n// –í–æ–∑–≤—Ä–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏\nreturn [\n  {\n    json: {\n      chatId: chatId,\n      message: aiResponse,\n      parse_mode: 'Markdown' // –∏–ª–∏ 'HTML', –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ HTML-—Ç–µ–≥–∏\n    }\n  }\n];"
      },
      "id": "b1a23a3f-18b1-4d05-8d6a-dcc7434dd1f5",
      "name": "‚ú® –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞",
      "type": "n8n-nodes-base.code",
      "position": [
        1936,
        -1040
      ],
      "typeVersion": 2
    },
    {
      "parameters": {
        "chatId": "={{ $json.chatId }}",
        "text": "={{ $json.message }}",
        "additionalFields": {
          "appendAttribution": false,
          "disable_web_page_preview": false,
          "parse_mode": "Markdown"
        }
      },
      "id": "5eac0401-7c02-4008-8ec0-b030d0b93e71",
      "name": "üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç–≤–µ—Ç–∞",
      "type": "n8n-nodes-base.telegram",
      "position": [
        2960,
        -1035.3488958990538
      ],
      "typeVersion": 1.2,
      "webhookId": "d935679d-352a-45b7-92a3-dd5b6c4262f3",
      "credentials": {
        "telegramApi": {
          "id": "bRtnxneEgvSWdsIe",
          "name": "–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç –ø–æ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥—É"
        }
      }
    },
    {
      "parameters": {
        "resource": "file",
        "fileId": "={{ $json.message.photo.slice(-1)[0].file_id }}"
      },
      "id": "f6692eee-c8a3-45e1-a187-c5890043eca7",
      "name": "üì∑ –ü–æ–ª—É—á–∏—Ç—å —Ñ–æ—Ç–æ",
      "type": "n8n-nodes-base.telegram",
      "position": [
        800,
        -887.3488958990538
      ],
      "typeVersion": 1.2,
      "webhookId": "ca638036-67e6-46c3-bbee-18328deb9653",
      "credentials": {
        "telegramApi": {
          "id": "bRtnxneEgvSWdsIe",
          "name": "–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç –ø–æ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥—É"
        }
      }
    },
    {
      "parameters": {
        "resource": "image",
        "operation": "analyze",
        "modelId": {
          "__rl": true,
          "value": "models/gemini-2.5-flash",
          "mode": "list",
          "cachedResultName": "models/gemini-2.5-flash"
        },
        "text": "=–¢—ã –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ñ–∏—Ç–Ω–µ—Å-—Ç—Ä–µ–Ω–µ—Ä. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —ç—Ç–æ —Ñ–æ—Ç–æ –∏ –¥–∞–π —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ:\n1. –û—Ü–µ–Ω–∫–µ –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ —Ç–µ–ª–∞\n2. –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–º —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è–º\n3. –í–æ–∑–º–æ–∂–Ω—ã–º –ø—Ä–æ–±–ª–µ–º–Ω—ã–º –∑–æ–Ω–∞–º\n4. –°–æ–≤–µ—Ç–∞–º –ø–æ –ø–æ–∑–µ –∏ —Ç–µ—Ö–Ω–∏–∫–µ\n\n–û—Ç–≤–µ—á–∞–π —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —ç–º–æ–¥–∑–∏. –ë—É–¥—å –¥–µ–ª–∏–∫–∞—Ç–Ω—ã–º –∏ –º–æ—Ç–∏–≤–∏—Ä—É—é—â–∏–º.?",
        "imageUrls": "={{ $json.data.url }}",
        "options": {}
      },
      "id": "387dcc9c-08cd-41c5-a1a2-b34fc0827bed",
      "name": "üîç –ê–Ω–∞–ª–∏–∑ —Ñ–æ—Ç–æ",
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "position": [
        1800,
        -887.3488958990538
      ],
      "typeVersion": 1,
      "credentials": {
        "googlePalmApi": {
          "id": "m4SgITdaNJaQzQMi",
          "name": "–ê–±–∞–∫—Å–∞–ª–ª—Ö"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.imgbb.com/1/upload?expiration=600&key= ed32dd04094897324bf60412a2b8c0c7",
        "sendBody": true,
        "contentType": "form-urlencoded",
        "bodyParameters": {
          "parameters": [
            {
              "name": "image",
              "value": "={{ $json.data }}"
            }
          ]
        },
        "options": {
          "redirect": {
            "redirect": {}
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1368,
        -887.3488958990538
      ],
      "id": "374c758c-533e-4d0c-8046-8afea23f13d2",
      "name": "HTTP Request"
    },
    {
      "parameters": {
        "operation": "binaryToPropery",
        "options": {}
      },
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        1024,
        -887.3488958990538
      ],
      "id": "c5059b6c-50c5-4ba0-b2e1-11968935744d",
      "name": "Extract from File"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.message.text || $('AI Agent').item.json.output }}",
        "messages": {
          "messageValues": [
            {
              "message": "=–ø–µ—Ä–µ–¥–µ–ª–∞–π —Ç–µ–∫—Å—Ç —á—Ç–æ–±—ã –±—ã–ª–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —á–µ–ª–æ—á–µ—á–µ—Å–∫–∏–π —Å—Ç–∏–ª—å –∏ –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ —Ç–µ–ª–µ–≥—Ä–∞–º –∫–∞–∫ —Ç–µ–∫—Å—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ markdown. –ù–∏—á–µ–≥–æ –ª–∏—à–Ω–µ–≥–æ –∏ –æ—Ç —Ç–µ–±—è –Ω–µ –¥–æ–±–∞–≤–ª—è–π. –¢–≤–æ—è –∑–∞–¥–∞—á–∞ –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –∏ –≤—Å—ë"
            },
            {
              "type": "AIMessagePromptTemplate",
              "message": "=–§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ –≤—Å–µ–≥–¥–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ Markdown –Ω–µ –ø—Ä–µ–≤—ã—à–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º–≤–æ–ª–æ–≤ –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –≤ –æ–¥–Ω–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏ –≤ Telegram —Ç–∞–∫–∂–µ —Å–æ–±–ª—é–¥–∞—Ç—å –≤—Å–µ –Ω—é–∞–Ω—Å—ã –∏ –ø—Ä–∞–≤–∏–ª–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ Markdown\n"
            }
          ]
        },
        "batching": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.7,
      "position": [
        2144,
        -1072
      ],
      "id": "e2213f92-f5d6-4a46-ac5b-2ad8f6575ac1",
      "name": "Basic LLM Chain"
    },
    {
      "parameters": {
        "modelName": "models/gemini-2.5-flash-lite",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        2432,
        -811.3488958990538
      ],
      "id": "665e7365-7b5d-4128-919a-f73d45a8099b",
      "name": "Google Gemini Chat Model",
      "credentials": {
        "googlePalmApi": {
          "id": "m4SgITdaNJaQzQMi",
          "name": "–ê–±–∞–∫—Å–∞–ª–ª—Ö"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.aiPrompt }}",
        "needsFallback": true,
        "options": {
          "systemMessage": "={{ $json.aiPrompt }}",
          "passthroughBinaryImages": true
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.1,
      "position": [
        1280,
        -1287.3488958990538
      ],
      "id": "4862b567-3bcf-439f-bba0-7848de02b499",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "={{ $('üì± Telegram Trigger').item.json.message.chat.id }}"
      },
      "type": "@n8n/n8n-nodes-langchain.memoryZep",
      "typeVersion": 1.3,
      "position": [
        1504,
        -1063.3488958990538
      ],
      "id": "bbea397d-e4b6-4f56-8909-127a80b1c5b5",
      "name": "Zep",
      "credentials": {
        "zepApi": {
          "id": "dg4NC8gu9VxR3vQQ",
          "name": "Zep Api account"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        1248,
        -1063.3488958990538
      ],
      "id": "89171b91-4ff2-46fe-8621-646f4b4d95a2",
      "name": "Google Gemini Chat Model1",
      "credentials": {
        "googlePalmApi": {
          "id": "m4SgITdaNJaQzQMi",
          "name": "–ê–±–∞–∫—Å–∞–ª–ª—Ö"
        }
      }
    },
    {
      "parameters": {
        "modelName": "models/gemini-2.5-pro-preview-03-25",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        1376,
        -1063.3488958990538
      ],
      "id": "203cb6d8-4e9d-4536-b31d-1d65d2047ee0",
      "name": "Google Gemini Chat Model2",
      "credentials": {
        "googlePalmApi": {
          "id": "m4SgITdaNJaQzQMi",
          "name": "–ê–±–∞–∫—Å–∞–ª–ª—Ö"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const cleanMessage = $json.text\n  .replace(/[*_`[\\]()]/g, '') // —É–¥–∞–ª—è–µ—Ç Markdown-—Å–∏–º–≤–æ–ª—ã\n  .replace(/\\\\n/g, '\\n');\n\nreturn [{\n  json: {\n    chatId: $('üì± Telegram Trigger').item.json.message.chat.id,\n    message: cleanMessage,\n    parse_mode: 'Markdown' // –∏–ª–∏ Plain Text\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2736,
        -1035.3488958990538
      ],
      "id": "51695587-ebf1-433d-b515-45b463006cda",
      "name": "Code"
    }
  ],
  "connections": {
    "üì± Telegram Trigger": {
      "main": [
        [
          {
            "node": "üîç –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ç–∏–ø –≤—Ö–æ–¥–∞",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üîç –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ç–∏–ø –≤—Ö–æ–¥–∞": {
      "main": [
        [
          {
            "node": "üë§ –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –ø—Ä–æ—Ñ–∏–ª—è",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "üì∑ –ü–æ–ª—É—á–∏—Ç—å —Ñ–æ—Ç–æ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üë§ –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –ø—Ä–æ—Ñ–∏–ª—è": {
      "main": [
        [
          {
            "node": "üìù –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø—Ä–æ–º–ø—Ç–æ–≤",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üìù –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø—Ä–æ–º–ø—Ç–æ–≤": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "‚ú® –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞": {
      "main": [
        [
          {
            "node": "Basic LLM Chain",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç–≤–µ—Ç–∞": {
      "main": [
        []
      ]
    },
    "üì∑ –ü–æ–ª—É—á–∏—Ç—å —Ñ–æ—Ç–æ": {
      "main": [
        [
          {
            "node": "Extract from File",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üîç –ê–Ω–∞–ª–∏–∑ —Ñ–æ—Ç–æ": {
      "main": [
        [
          {
            "node": "‚ú® –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request": {
      "main": [
        [
          {
            "node": "üîç –ê–Ω–∞–ª–∏–∑ —Ñ–æ—Ç–æ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract from File": {
      "main": [
        [
          {
            "node": "HTTP Request",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Basic LLM Chain": {
      "main": [
        [
          {
            "node": "Code",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Basic LLM Chain",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "‚ú® –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Zep": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model2": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 1
          }
        ]
      ]
    },
    "Code": {
      "main": [
        [
          {
            "node": "üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç–≤–µ—Ç–∞",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1"
  },
  "triggerCount": 1,
  "versionId": "4a28cc6e-5744-4ebc-bc8c-9055bc844a26",
  "owner": {
    "type": "personal",
    "projectId": "4u7zt7bOYo5vK3bD",
    "projectName": "Sali Costa <withabakirov@gmail.com>",
    "personalEmail": "withabakirov@gmail.com"
  },
  "parentFolderId": null,
  "isArchived": false
}